# Sysex 메세지
여기서는 Sysex 메세지를 통해 보내는 명령들에 대해 서술한다.

제조사 ID(manufacturer id: 생산자 ID)에 대해서는 [여기](./sysexManufacturerId.md)를 참조하라.

## 장치 ID란?
**장치 ID**(Device ID)는 여러 개의 장치가 하나의 MIDI 포트로 연결되어 있는 상태에서 이 포트로 Sysex 메세지를 보낼 때 장치를 식별하기 위한 번호이다. Sysex 메세지를 받은 신시사이저는 이 메세지가 자신이 처리할 메세지인지를 이 장치 ID를 통해 확인한다. 이때 장치 ID가 127(`0x7F`)인 경우 그 포트에 연결된 모든 장치가 그 메세지를 처리하도록 되어 있다.

일반적으로 포트 하나당 하나의 장치가 연결되므로 거의 쓸 일이 없지만, whitesynth의 경우 Synth 개체를 생성하면 기본 장치 ID는 16(`0x10`)으로 설정된다.

## 추가사항
공식을 적어 놓은 경우, 따로 명시된 것 없이 그냥 "공식: ... " 과 같이 적으면 해당 공식은 원래 값(얘를 x라 함)을 Sysex용 값으로 변환하는 공식이다.

명령별로 보낼 값의 길이가 정해져 있지만, 그보다 많이 보내도 적게 보내도 상관없다. 많이 보내면 뒷부분을 무시하고, 적게 보내면 명령을 무시한다.

### 설명 예시

- 데이터: `kk ll mm` - 실제로 데이터를 보낼 때의 형태
  - `kk`: 0 - 127 (기본값: 100) - 값의 범위(파라미터인 경우 기본값을 추가로 기재함)
  - `mm ll`: 0 - 16383 (기본값: 16383) - 여기서 `mm ll` 과 같이 적은 건 이 순서대로 big endian이다.

## 표준 실시간 메세지

### 기본 구조
```
F0 7F 7F rr rr vv ... vv F7
```
- `F0` = 이 메세지가 Sysex 메세지임을 의미함
- `7F` = 제조사 ID (표준 실시간 메세지)
- `7F` = 장치 ID (연결된 모든 MIDI 입력 장치)
- `rr rr` = 명령 ID
- `vv ... vv` = 데이터
- `F7` = Sysex의 끝

명령 ID의 첫 바이트는 그 명령 ID의 큰 분류를 나타낸다.
- `04` - 장치 제어

### Master volume - `04 01`
최종 출력의 음량을 설정한다.

- 전체 Sysex 형태: `F0 7F 7F 04 01 ll mm F7`
- 데이터: `ll mm`
  - `mm ll`: 0 - 16383 (기본값 = 16383)

### Master fine tuning - `04 03`
cent 단위로 전체 음높이를 조율한다. 1키 = 100cent이다.

- 전체 Sysex 형태: `F0 7F 7F 04 03 ll mm F7`
- 데이터: `ll mm`
  - `mm ll`: 0 - 8192 - 16383 (기본값 = 8192. 이 값을 x라 할 때, cent 단위로 변환한 값 = `100 / 8192 * (x - 8192)`)

### Master coarse tuning - `04 04`
전체 음높이를 1키 단위로 조절한다.

- 전체 Sysex 형태: `F0 7F 7F 04 04 kk F7`
- 데이터: `kk`
  - `kk`: 40 - 64 - 88 (-24 - 0 - +24, 기본값 = 0)

## 표준 비-실시간 메세지

### 기본 구조
```
F0 7E 7F rr rr vv ... vv F7
```
- `F0` = 이 메세지가 Sysex 메세지임을 의미함
- `7E` = 제조사 ID (표준 비-실시간 메세지)
- `7F` = 장치 ID (연결된 모든 MIDI 입력 장치)
- `rr rr` = 명령 ID
- `vv ... vv` = 데이터
- `F7` = Sysex의 끝

명령 ID의 첫 바이트는 그 명령 ID의 큰 분류를 나타낸다.
- `06` - 기본 정보

### Identity request - `06 01`
미디 장치의 정보를 요청한다. 이러면 미디음원 쪽에서 아래 서술된 Identity reply 메세지를 보낸다. 

- 전체 Sysex 형태: `F0 7E 7F 06 01 F7`
- 데이터: 없음

### Identity reply - `06 02`
미디 장치가 위의 Identity request 메세지를 받으면 보내는 메세지. **사용자가 보내는 게 아니다!**

- 전체 Sysex 형태: `F0 7E 7F 06 02 7D 19 72 11 21 mm jj ii pp F7`
- 데이터: `7D 00 00 0B 15 mm jj ii pp`
  - `7D`: 제조사 ID (개발/테스트용)
  - `00 00`: 제품군 ID
  - `0B 15`: 모델 ID (whitesynth)
  - `mm jj ii pp`: 장치 버전 (whitsynth의 경우 현재 프로그램의 버전을 반환한다)
    - `mm jj`: 메이저 버전
    - `ii`: 마이너 버전
    - `pp`: 패치 버전

## Roland GS 확장 메세지

### GS reset
GS Mode로 리셋을 한다.

#### 구조
```
F0 41 10 42 12 40 00 7F 00 41 F7
```
- `F0` = 이 메세지가 Sysex 메세지임을 의미함
- `41` = 제조사 ID (Roland)
- `10` = 장치 ID
- `42` = 모델 ID (GS)
- `12` = 명령 ID
- `40 00 7F` = GS Mode set
- `00` = 데이터(이대로 놔두자)
- `41` = 체크섬(Roland SCVA 설명서 109페이지 참조)
- `F7` = Sysex의 끝

## whitesynth용 확장 메세지

### 기본 구조
```
F0 7D 10 0B 15 rr rr rr rr vv ... vv F7
```
- `F0` = 이 메세지가 Sysex 메세지임을 의미함
- `7D` = 제조사 ID (개발/테스트용)
- `10` = 장치 ID
- `0B 15` = 모델 ID (whitesynth)
- `rr rr rr rr` = 명령 ID
- `vv ... vv` = 데이터
- `F7` = Sysex의 끝

### 명령어 목록
목록을 보려면 [여기](./whitesynthSysexCommandsList.md)로