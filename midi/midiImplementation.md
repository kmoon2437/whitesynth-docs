# 미디 신호 구현
대부분 roland sound canvas va와 호환되게 만들었다.

값의 공식을 적어 놓은 경우, 해당 공식은 일반 값(얘를 x라 함)을 midi 메세지용 값으로 변환하는 공식이다.

## Note off
음표를 끈다(소리를 멈춘다).

### 형식
```
8n kk vv
```
또는
```
9n kk 00 # note on에 velocity 값이 0인 경우
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- `kk` = note 번호: 0 - 127(`0x00` - `0x7f`,60 (`0x3c`) = 가운데 도)
- `vv` = velocity이긴 한데, note를 끄는데는 의미가 없으므로 이 값은 무시됨

## Note on
음표를 켠다(소리를 낸다).

### 형식
```
9n kk vv
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- `kk` = note 번호: 0 - 127(`0x00` - `0x7f`,60 (`0x3c`) = 가운데 도)
- `vv` = velocity(note의 세기): 0 - 127(`0x01` - `0x7f`인데 왜 1부터냐면 0을 집어넣으면 note off로 해석하기 때문)

## Note aftertouch(Polyphonic aftertouch)
건반을 누르고 나서 좀 더 힘을 주거나 흔드는 식으로 소리에 변형을 가한다.

관련 설정값은 Sysex로 제어하며, 모든 것을 기본값으로 놔둘 경우 이 메세지는 아무런 효과가 없다.

### 형식
```
An kk vv
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- `kk` = note 번호: 0 - 127(`0x00` - `0x7f`,60 (`0x3c`) = 가운데 도)
- `vv` = 변형의 정도: 0 - 127(`0x00` - `0x7f`)

## Control change
이른바 「CC」. 기본 메세지 형식으로는 부족한 많은 파라미터들을 조정한다.

이걸로 제어할 수 있는 파라미터가 많아 다 넣으면 문서가 길어지니 자세한 건 [여기](./controlChanges.md)를 참조하라.

### 형식
```
Bn kk vv
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- `kk` = 파라미터 번호: 0 - 127(`0x00` - `0x7f`)
- `vv` = 파라미터 값: 0 - 127(`0x00` - `0x7f`)

## Program change
악기를 바꾸는데, 바뀐 악기는 바뀐 뒤의 note on부터 반영된다.

### 형식
```
Cn kk
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- `kk` = 악기 번호: 0 - 127(`0x00` - `0x7f`)

## Channel aftertouch
기본적으로 Note aftertouch와 같으나, 얘는 note 단위가 아닌 채널 단위이다.

마찬가지로 관련 설정값은 Sysex로 제어하며, 모든 것을 기본값으로 놔둘 경우 이 메세지는 아무런 효과가 없다.

### 형식
```
Dn vv
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- `vv` = 변형의 정도: 0 - 127(`0x00` - `0x7f`)

## Pitch bend wheel
피치(음높이)를 조정한다. 정밀한 조정을 위해 2바이트를 사용한다.

### 형식
```
En kk ll
```
- `n` = 미디 채널 번호: 1 - 16(`0x0` - `0xf`)
- kk ll = 값: -8192 - 0 - +8191(`0x00 0x00` - `0x7f 0x7f`. 리틀 엔디언이다)

## Sysex (System exclusive) 메세지
Control change로도, 그 Control change 문서의 제일 밑에 나올 NRPN으로도 부족한 부분을 채워준다.(?)
각종 설정이나 설정값 초기화 등에 사용된다.

### 형식
```
F0 gg hh ii jj ...... F7
```
- `F0` = 여기부터 Sysex 메세지임을 의미함
- `gg` = 제조사(manufacturer: 생산자) ID: `0x00` - `0x7f`(자세한 건 [여기](../sysex/sysexManufacturerId.md) 참조)
- `hh ii jj ......` = 데이터: 각각 `0x00` - `0x7f`(...라고는 했지만, 처음 2바이트(hh,ii)는 위에서 서술했듯 gg가 `0x00`일 때 생산자 ID의 일부분으로 쓰인다)
- `F7` = Sysex의 끝을 의미하며, 데이터가 얼마나 길어질지 모르기에 이걸 사용해 끝을 나타낸다